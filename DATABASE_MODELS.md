# نماذج قاعدة البيانات - نظام إدارة حجوزات الفنادق

## 📋 نظرة عامة

تم إنشاء نماذج قاعدة البيانات لنظام إدارة حجوزات الفنادق باستخدام MongoDB و Mongoose. النظام يدعم اللغتين العربية والإنجليزية ويتضمن جميع الميزات المطلوبة.

## 🗂️ النماذج المتاحة

### 1. نموذج المستخدم (User)
**الملف:** `models/user.model.js`

**الحقول الرئيسية:**
- `fullName`: الاسم الكامل
- `email`: البريد الإلكتروني (فريد)
- `phone`: رقم الهاتف
- `password`: كلمة المرور (مشفرة)
- `role`: الدور (ADMIN, RECEPTIONIST, CUSTOMER)
- `avatar`: صورة الملف الشخصي
- `preferredLanguage`: اللغة المفضلة
- `isActive`: حالة الحساب

**الميزات:**
- تشفير كلمة المرور تلقائياً
- التحقق من صحة البريد الإلكتروني
- نظام الأدوار والصلاحيات

### 2. نموذج البلد (Country)
**الملف:** `models/country.model.js`

**الحقول الرئيسية:**
- `name`: اسم البلد (عربي/إنجليزي)
- `code`: رمز البلد (ISO)
- `phoneCode`: رمز الهاتف الدولي
- `currency`: معلومات العملة
- `isActive`: حالة البلد

### 3. نموذج المحافظة (Governorate)
**الملف:** `models/governorate.model.js`

**الحقول الرئيسية:**
- `name`: اسم المحافظة (عربي/إنجليزي)
- `country`: معرف البلد (ObjectId)
- `code`: رمز المحافظة
- `location`: الموقع الجغرافي
- `isActive`: حالة المحافظة

### 4. نموذج المنطقة (Region)
**الملف:** `models/region.model.js`

**الحقول الرئيسية:**
- `name`: اسم المنطقة (عربي/إنجليزي)
- `country`: معرف البلد (ObjectId)
- `governorate`: معرف المحافظة (ObjectId)
- `code`: رمز المنطقة
- `postalCode`: الرمز البريدي
- `location`: الموقع الجغرافي

### 5. نموذج الفندق (Hotel)
**الملف:** `models/hotel.model.js`

**الحقول الرئيسية:**
- `name`: اسم الفندق (عربي/إنجليزي)
- `type`: نوع الفندق
- `stars`: تصنيف النجوم (1-5)
- `country`: معرف البلد
- `governorate`: معرف المحافظة
- `region`: معرف المنطقة
- `address`: العنوان (عربي/إنجليزي)
- `description`: الوصف (عربي/إنجليزي)
- `images`: صور الفندق
- `amenities`: المرافق والخدمات
- `rating`: التقييم
- `owner`: معرف المالك

### 6. نموذج الغرفة (Room)
**الملف:** `models/room.model.js`

**الحقول الرئيسية:**
- `name`: اسم الغرفة (عربي/إنجليزي)
- `hotel`: معرف الفندق
- `type`: نوع الغرفة
- `roomNumber`: رقم الغرفة
- `floor`: رقم الطابق
- `bedsCount`: عدد الأسرة
- `area`: مساحة الغرفة
- `maxGuests`: الحد الأقصى للنزلاء
- `amenities`: مرافق الغرفة
- `pricing`: معلومات التسعير
- `status`: حالة الغرفة

### 7. نموذج الخدمة (Service)
**الملف:** `models/service.model.js`

**الحقول الرئيسية:**
- `name`: اسم الخدمة (عربي/إنجليزي)
- `type`: نوع الخدمة
- `description`: وصف الخدمة
- `price`: السعر
- `pricingType`: نوع التسعير
- `isMandatory`: هل الخدمة إلزامية
- `isAvailable`: هل الخدمة متاحة
- `hotels`: الفنادق المرتبطة
- `settings`: إعدادات الخدمة

### 8. نموذج الحجز (Booking)
**الملف:** `models/booking.model.js`

**الحقول الرئيسية:**
- `bookingNumber`: رقم الحجز (فريد)
- `customer`: معرف العميل
- `hotel`: معرف الفندق
- `room`: معرف الغرفة
- `guestInfo`: بيانات النزيل
- `guestsCount`: عدد النزلاء
- `checkInDate`: تاريخ الوصول
- `checkOutDate`: تاريخ المغادرة
- `status`: حالة الحجز
- `pricing`: تفاصيل التسعير
- `payment`: معلومات الدفع
- `services`: الخدمات الإضافية

## 🔗 العلاقات بين النماذج

```
Country (البلد)
├── Governorate (المحافظة)
│   ├── Region (المنطقة)
│   └── Hotel (الفندق)
│       ├── Room (الغرفة)
│       └── Service (الخدمة)
└── User (المستخدم)
    └── Booking (الحجز)
        ├── Room (الغرفة)
        └── Service (الخدمات الإضافية)
```

## 🛠️ الميزات المتقدمة

### التحقق من صحة البيانات
- جميع النماذج تتضمن تحقق شامل من صحة البيانات
- رسائل خطأ باللغة العربية
- التحقق من العلاقات بين النماذج

### الفهرسة
- فهارس محسنة للبحث السريع
- فهارس جغرافية للمواقع
- فهارس نصية للبحث متعدد اللغات

### Virtual Fields
- حقول محسوبة تلقائياً
- عدادات للعلاقات المرتبطة
- معلومات إضافية مشتقة

### Middleware
- تشفير كلمات المرور تلقائياً
- توليد أرقام الحجز الفريدة
- التحقق من صحة العلاقات
- حساب القيم التلقائية

## 📦 ملفات الدعم

### معالج الأخطاء
**الملف:** `utils/errorHandler.js`
- فئة أخطاء مخصصة
- معالج أخطاء شامل
- رسائل خطأ باللغة العربية

### بذور البيانات
**الملف:** `utils/seedData.js`
- بيانات البلدان الأساسية
- المحافظات السعودية
- مناطق الرياض
- مستخدم مدير افتراضي

### فهرس النماذج
**الملف:** `models/index.js`
- تصدير جميع النماذج
- دوال مساعدة للإدارة
- إنشاء الفهارس

## 🚀 كيفية الاستخدام

### 1. تشغيل بذور البيانات
```bash
node scripts/seedDatabase.js
```

### 2. استيراد النماذج
```javascript
const { User, Hotel, Booking } = require('./models');
```

### 3. إنشاء حجز جديد
```javascript
const booking = new Booking({
    customer: customerId,
    hotel: hotelId,
    room: roomId,
    guestInfo: {
        fullName: 'أحمد محمد',
        email: 'ahmed@example.com',
        phone: '+966501234567'
    },
    checkInDate: new Date('2024-01-15'),
    checkOutDate: new Date('2024-01-18'),
    // ... باقي البيانات
});

await booking.save();
```

## 🔐 بيانات المدير الافتراضي

بعد تشغيل بذور البيانات:
- **البريد الإلكتروني:** admin@hotel.com
- **كلمة المرور:** admin123456

⚠️ **تذكير:** يرجى تغيير كلمة المرور بعد أول تسجيل دخول!

## 📝 ملاحظات مهمة

1. جميع النماذج تدعم اللغتين العربية والإنجليزية
2. التحقق من صحة البيانات شامل ومفصل
3. العلاقات بين النماذج محمية ومتحققة
4. الفهارس محسنة للأداء
5. معالجة الأخطاء شاملة وباللغة العربية

## 🔄 التحديثات المستقبلية

يمكن إضافة نماذج إضافية مثل:
- نموذج التقييمات والمراجعات
- نموذج العروض والخصومات
- نموذج التقارير والإحصائيات
- نموذج الإشعارات
- نموذج سجل العمليات
